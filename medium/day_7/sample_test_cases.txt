Example

Input:
5 2
1 2 3 1 1

Output:
10